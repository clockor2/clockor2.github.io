(self.webpackChunkclockor2=self.webpackChunkclockor2||[]).push([[492,928],{99143:function(t,e,n){"use strict";var i=n(49967),a=n(73843),r=[0,0];t.exports=function(t,e,n){var s,o=void 0===(e=e||{}).tolerance?1e-8:e.tolerance,l=void 0===e.initialIncrement?1:e.initialIncrement,c=void 0===e.lowerBound?-1/0:e.lowerBound,h=void 0===e.upperBound?1/0:e.upperBound,d=void 0===e.maxIterations?100:e.maxIterations;if(n&&(n.iterations=0,n.argmin=NaN,n.minimum=1/0,n.converged=!1),isFinite(h)&&isFinite(c))r[0]=c,r[1]=h;else if(s=void 0===e.guess?c>-1/0?h<1/0?.5*(c+h):c:h<1/0?h:0:e.guess,a(r,t,s,l,c,h,d),isNaN(r[0])||isNaN(r[1]))return NaN;return i(t,r[0],r[1],o,d,n)}},73843:function(t){"use strict";t.exports=function(t,e,n,i,a,r,s){var o,l,c,h,d,u,p;h=1,d=n,u=n,c=l=o=e(n);for(;!p&&isFinite(i)&&!isNaN(i);)if(++h,p=!0,l<=c&&(c=l,d=Math.max(a,d-i),l=e(d),p=!1),o<=c&&(c=o,u=Math.min(r,u+i),o=e(u),p=!1),c=Math.min(c,l,o),(l===c&&d===a||o===c&&u===r)&&(p=!0),i*=h<4?2:Math.exp(.5*h),!isFinite(i))return t[0]=-1/0,t[1]=1/0,t;return t[0]=d,t[1]=u,t}},49967:function(t){"use strict";var e=2/(1+Math.sqrt(5));t.exports=function(t,n,i,a,r,s){var o,l,c=0,h=i-e*(i-n),d=n+e*(i-n),u=t(h),p=t(d),_=t(n),f=t(i),g=n,m=i;for(;++c<r&&Math.abs(i-n)>a;)p>u?(i=d,d=h,p=u,u=t(h=i-e*(i-n))):(n=h,h=d,u=p,p=t(d=n+e*(i-n)));o=.5*(i+n),l=.5*(u+p),s&&(s.iterations=c,s.argmin=o,s.minimum=l,s.converged=!0);if(isNaN(p)||isNaN(u)||c===r)return s&&(s.converged=!1),NaN;return _<l?g:f<l?m:o}},9928:function(t,e,n){var i=n(861).default,a=n(56690).default,r=n(89728).default,s=n(27424).default;!function(t,e,n,o){"use strict";function l(t){if(t&&t.__esModule)return t;var e=Object.create(null);return t&&Object.keys(t).forEach((function(n){if("default"!==n){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})),e.default=t,Object.freeze(e)}var c=l(e),h=l(n),d=l(o),u=function(t,e){var n;return parseString(t,(function(t,e){n=e["nex:nexml"].trees[0].tree.map((function(t){var e=t.node.map((function(t){return t.$})),n=e.reduce((function(t,e){return e.edges=[],e.name=e.id,t[e.id]=e,t}),{}),i=e.filter((function(t){return t.root})),a=i>0?i[0].id:e[0].id;function r(t,e){if(t.edges){var i=h.pluck(t.edges,"target");t.children=h.values(h.pick(n,i)),t.children.forEach((function(e,n){e.attribute=t.edges[n].length||""})),t.children.forEach(r),t.annotation=""}}return n[a].name="root",t.edge.map((function(t){return t.$})).forEach((function(t){n[t.source].edges.push(t)})),r(n[a]),n[a]}))})),n};function p(t,e,n,i){var a=this.nodes.descendants();if(t.parent&&a.indexOf(t)>=0){var r=t.parent.children.indexOf(t),s={name:n,parent:t.parent,attribute:i?i[2]:null,original_child_order:t.original_child_order},o={name:e,parent:s,attribute:i?i[1]:null,original_child_order:2};s.children=[t,o],t.parent.children[r]=s,t.parent=s,t.attribute=i?i[0]:null,t.original_child_order=1}return this}function _(t){var e=this.nodes.descendants();if("number"!=typeof t)return this.deleteANode(e.indexOf(t));if(t>0&&t<e.length){var n=e[t];if(n.parent){var i=n.parent.children.indexOf(n);i>=0&&(e.splice(t,1),n.children&&n.children.forEach((function(t){t.original_child_order=n.parent.children.length,n.parent.children.push(t),t.parent=n.parent})),n.parent.children.length>2?n.parent.children.splice(i,1):n.parent.parent?(n.parent.parent.children[n.parent.parent.children.indexOf(n.parent)]=n.parent.children[1-i],n.parent.children[1-i].parent=n.parent.parent,e.splice(e.indexOf(n.parent),1)):(e.splice(0,1),e.parent=null,delete e.data.attribute,delete e.data.annotation,delete e.data.original_child_order,e.name="root",e.data.name="root"))}}return this}function f(){return h.filter(this.nodes.descendants(),(function(t){return!h.has(t,"children")}))}function g(){return h.filter(this.nodes.descendants(),(function(t){return h.has(t,"children")}))}function m(){return this.nodes}function v(){return this.nodes}function b(t){return h.filter(this.nodes.descendants(),(function(e){return e.data.name==t}))[0]}function y(t){h.each(this.nodes,(function(e){h.indexOf(h.keys(t),e.name)>=0&&(e.annotations=t[e.name])}))}function x(t){return!h.has(t,"children")}function w(t,e){return this.nodes.each((function(n){t in n&&(e&&(n[e]=n[t]),delete n[t])})),this}function k(t){var e=this;t||this.nodes.each((function(t){x(t)||(t[e.selection_attribute_name]=!1,t.data.traits||(t.data.traits={}),t.data.traits[e.selection_attribute_name]=t[e.selection_attribute_name])}))}var N=Object.freeze({__proto__:null,graftANode:p,deleteANode:_,getTips:f,getInternals:g,getRootNode:m,getNodes:v,getNodeByName:b,assignAttributes:y,isLeafNode:x,updateKeyName:w,clearInternalNodes:k});function z(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=/^-?\d+(\.\d+)?$/,i=e.left_delimiter||"{",a=e.right_delimiter||"}",r=[];function o(){var t={name:null},e=r[r.length-1];"children"in e||(e.children=[]),r.push(t),e.children.push(r[r.length-1]),r[r.length-1].original_child_order=e.children.length}function l(){var t=r.pop();t.name=d,"children"in t?t.bootstrap_values=d:t.name=d,t.attribute=u,"["==i&&p.includes("&&NHX")?p.split(":").slice(1).forEach((function(e){var i=e.split("="),a=s(i,2),r=a[0],o=a[1];t[r]=n.test(o)?+o:o})):t.annotation=p,d="",u="",p=""}function c(e){return{json:null,error:"Unexpected '"+t[e]+"' in '"+t.substring(e-20,e+1)+"[ERROR HERE]"+t.substring(e+1,e+20)+"'"}}var h=0,d="",u="",p="",_=null,f={"'":1,'"':1},g={name:"root"};r.push(g);for(var m=/\s/,v=0;v<t.length;v++)try{var b=t[v];switch(h){case 0:"("==b&&(o(),h=1);break;case 1:case 3:if(":"==b)h=3;else if(","==b||")"==b)try{l(),h=1,","==b&&o()}catch(y){return c(v)}else if("("==b){if(d.length>0)return c(v);o()}else{if(b in f){if(1==h&&0===d.length&&0===u.length&&0===p.length){h=2,_=b;continue}return c(v)}if(b==i){if(p.length)return c(v);h=4}else if(3==h)u+=b;else{if(m.test(b))continue;if(";"==b){v=t.length;break}d+=b}}break;case 2:if(b==_){if(v<t.length-1&&t[v+1]==_){v++,d+=_;continue}_=0,h=1;continue}d+=b;break;case 4:if(b==a)h=3;else{if(b==i)return c(v);p+=b}}}catch(y){return c(v)}return 1!=r.length?c(t.length-1):{json:g,error:null}}function E(t){var e=this;function n(a){x(a)||(i.push("("),a.children.forEach((function(t,e){e&&i.push(","),n(t)})),i.push(")")),"root"!=a.data.name&&i.push(a.data.name),i.push(t(a));var r=e.branch_length_accessor(a);void 0!==r&&i.push(":"+r)}t||(t=function(t){return""});var i=[];return t=t||"",n(this.nodes),i.join("")+";"}function M(t){var e=t,n=e.toUpperCase().indexOf("BEGIN DATA;"),i=e.slice(n);if(i.length<2)return"";n=i.toUpperCase().indexOf("END;");var a=i.slice(0,n);i=h.map(a.split(";"),(function(t){return t.trim()}));var r=h.filter(i,(function(t){return t.toUpperCase().startsWith("DIMENSION")}));r=r[0].split(" "),r=h.object(h.map(h.rest(r),(function(t){return t.split("=")})));var s=h.filter(i,(function(t){return t.toUpperCase().startsWith("FORMAT")}));s=s[0].split(" "),(s=h.object(h.map(h.rest(s),(function(t){return t.split("=")})))).symbols=h.reject(s.symbols.split(""),(function(t){return'"'==t}));var o=h.filter(i,(function(t){return t.toUpperCase().startsWith("MATRIX")}));return o=o[0].split("\n"),o=h.object(h.map(h.rest(o),(function(t){return h.compact(t.split(" "))}))),o=h.mapObject(o,(function(t,e){return"?"==t?s.symbols:Array(t)})),{dimensions:r,format:s,matrix:o}}function S(t,e,n){h.each(t.getTips(),(function(t){t.data.test=n.matrix[t.data.name]}))}function L(t){var e=t,n=e.toUpperCase().indexOf("BEGIN TREES;"),i=e.slice(n);if(i.length<2)return"";n=i.toUpperCase().indexOf("END;");var a=i.slice(0,n).split("\n");return z((a=h.filter(a,(function(t){return t.trim().toUpperCase().startsWith("TREE")})))[0])}var A=Object.freeze({__proto__:null,parseAnnotations:M,loadAnnotations:S,default:L});function O(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var n=0;n<t.attributes.length;n++){var i=t.attributes.item(n);e["@attributes"][i.nodeName]=i.nodeValue}}}else 3==t.nodeType&&(e=t.nodeValue);if(t.hasChildNodes()&&1===t.childNodes.length&&3===t.childNodes[0].nodeType)e=t.childNodes[0].nodeValue;else if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++){var r=t.childNodes.item(a),s=r.nodeName;if("undefined"==typeof e[s])e[s]=O(r);else{if("undefined"==typeof e[s].push){var o=e[s];e[s]=[],e[s].push(o)}e[s].push(O(r))}}return e}var T=function(t,e){function n(t,e){t.clade&&(t.clade.forEach(n),t.children=t.clade,delete t.clade),t.annotation=1,t.attribute="0.01",t.branch_length&&(t.attribute=t.branch_length),t.taxonomy&&(t.name=t.taxonomy.scientific_name),t.annotation=""}var i;return(i=(t=O(t)).phyloxml.phylogeny.clade).name="root",n(i),{json:i,error:null}};function j(t,e){e.left_delimiter="[",e.right_delimiter="]";var n=z(t,e);function i(t){if(t.annotation){t.beast={};for(var e=t.annotation.split(/=|,|{|}/).filter((function(t){return t})),n=0;n<e.length;n+=2){var a=e[n].replace(/&|%/g,"");/[a-df-zA-DF-Z]+/.test(e[n+2])?t.beast[a]=+e[n+1]:(t.beast[a]=[+e[n+1],+e[n+2]],n++)}}t.annotation=void 0,t.children&&t.children.forEach(i)}return i(n.json),n}var C={nexml:u,phyloxml:T,nexus:L,nwk:z,nhx:z,beast:j};function P(){var t=this.getTips(),e=h.map(t,(function(t){return{name:t.data.name,length:parseFloat(t.data.attribute)}}));return e=h.sortBy(e,(function(t){return-t.length}))}function R(t,e){function n(t,e){if(e.mp=[[0,0],[!1,!1]],x(e))e.mp[1][0]=e.mp[1][1]=e[t]||!1,e.mp[0][0]=e.mp[1][0]?1:0,e.mp[0][1]=1-e.mp[0][0];else{e.children.forEach(i);var n=e.children.reduce((function(t,e){return e.mp[0][0]+t}),0),a=e.children.reduce((function(t,e){return e.mp[0][1]+t}),0);e[t]?(e.mp[0][0]=a+1,e.mp[1][0]=!0,e.mp[0][1]=a,e.mp[1][1]=!0):(n<a+1?(e.mp[0][0]=n,e.mp[1][0]=!1):(e.mp[0][0]=a+1,e.mp[1][0]=!0),a<n+1?(e.mp[0][1]=a,e.mp[1][1]=!0):(e.mp[0][1]=n+1,e.mp[1][1]=!1))}}var i=h.partial(n,e);i(this.nodes),this.nodes.each((function(t){t.parent?t.mp=t.mp[1][t.parent.mp?1:0]:t.mp=t.mp[1][t.mp[0][0]<t.mp[0][1]?0:1]})),this.display.modifySelection((function(t,n){return x(t.target)?t.target[e]:t.target.mp}))}function B(t,e,n){for(var i,a,r,s=[t],o=[];t=s.pop();)if((!n||!n(t))&&(o.push(t),i=t.children))for(a=0,r=i.length;a<r;++a)s.push(i[a]);for(;t=o.pop();)e(t);return t}function H(t,e,n){for(var i,a,r=[t];t=r.pop();)if((!n||!n(t))&&(e(t),i=t.children))for(a=i.length-1;a>=0;--a)r.push(i[a]);return t}function I(t,e,n){var i,a,r,s,o=[t];do{for(i=o.reverse(),o=[];t=i.pop();)if((!n||!n(t))&&(e(t),a=t.children))for(r=0,s=a.length;r<s;++r)o.push(a[r])}while(o.length);return t}function U(t){return B(t,(function(t){t.children&&(t.children[0].data.multiway_parent=t,t.children[1].data.multiway_parent=t.parent)})),d.map(t.descendants(),(function(t){var e=t.data.multiway_parent,n="unknown";return e&&(n=e.data.name),{source:t.data.multiway_parent,target:t,name:n}}))}function D(){var t=this.branch_length;return!!t&&h.every(this.nodes.descendants(),(function(e){return!e.parent||!h.isUndefined(t(e))}))}function F(){var t=this.branch_length;return h.map(this.nodes.descendants(),(function(e){return t(e)}))}function q(t,e){var n=t.data;if("attribute"in n&&n.attribute&&n.attribute.length){e>0&&(n.attribute=String(e));var i=parseFloat(n.attribute);if(!isNaN(i))return Math.max(0,i)}if("root"==n.name)return 0;console.warn(n),console.warn("Undefined branch length at "+n.name+"!")}function V(t){return arguments.length?(this.branch_length_accessor=t||q,this):this.branch_length_accessor}function X(t){var e=this.branch_length,n=h.map(this.nodes.descendants(),(function(t){return e(t)?e(t):null})),i=h.max(n),a=h.min(n),r=function(t){return(t-a)/(i-a)};return h.each(this.nodes.descendants(),(function(t){var n=e(t);n&&e(t,r(n))})),this}function G(t){var e=this.branch_length;return h.each(this.nodes.descendants(),(function(n){var i=e(n);i&&e(n,t(i))})),this}function W(t){return arguments.length?(this.nodeLabel=t,this):this.nodeLabel}function $(t,e){var n=this;if(!(t instanceof c.hierarchy))throw new Error("node needs to be an instance of a d3.hierarchy node!");var i=this.nodes.copy();if(e=void 0!==e?e:.5,t.parent){var a=c.hierarchy({name:"new_root"});a.children=[t.copy()],a.data.__mapped_bl=void 0,i.each((function(t){t.data.__mapped_bl=n.branch_length_accessor(t)})),this.setBranchLength((function(t){return t.data.__mapped_bl}));var r,s=t,o=t.parent,l=h.noop(),d=void 0===t.data.__mapped_bl?void 0:t.data.__mapped_bl*e;if(l=o.data.__mapped_bl,o.data.__mapped_bl=void 0===t.data.__mapped_bl?void 0:t.data.__mapped_bl-d,t.data.__mapped_bl=d,o.parent){for(a.children.push(o);o.parent;){r=o.children.indexOf(s),o.parent.parent?o.children.splice(r,1,o.parent):o.children.splice(r,1);var u=o.parent.data.__mapped_bl;void 0!==u&&(o.parent.data.__mapped_bl=l,l=u),s=o,o=o.parent}r=o.children.indexOf(s),o.children.splice(r,1)}else r=o.children.indexOf(s),o.children.splice(r,1),l=o.data.__mapped_bl,s=a;if(1==o.children.length)l&&(o.children[0].data.__mapped_bl+=l),s.children=s.children.concat(o.children);else{var p=new c.hierarchy({name:"__reroot_top_clade",__mapped_bl:l});h.extendOwn(a.children[0],t),p.data.__mapped_bl=l,p.children=o.children.map((function(t){return t.parent=p,t})),p.parent=s,s.children.push(p)}}if(this.update(a),this.traverse_and_compute((function(t){h.each(t.children,(function(e){e.parent=t}))}),"pre-order"),!h.isUndefined(this.display)){var _=this.display.options;c.select(this.display.container).select("svg").remove();var f=this.display.selection_attribute_name;delete this.display;var g=this.render(_);g.selectionLabel(f),g.update(),c.select(g.container).node().appendChild(g.show()),c.select(this.display.container).dispatch("reroot")}return this}function Y(t,e){if(t=t||"attribute",e=e||"y_scaled","parent"in this){var n=parseFloat(this[t]);this[e]=this.parent[e]+(isNaN(n)?.1:n)}else this[e]=0;return this[e]}function Z(t){for(var e=[];t;)e.push(t),t=t.parent;return e}var J=Object.freeze({__proto__:null,reroot:$,rootpath:Y,pathToRoot:Z});function K(t){return t.y}function Q(t){return t.x}function tt(t,e,n){return{x:n+t*Math.sin(e),y:n+t*Math.cos(e)}}function et(t,e,n,i,a,r){t.radius=e*(t.radius+n),t.angle=2*Math.PI*t.x*a[0]/r[0];var s=tt(t.radius,t.angle,i);return t.x=s.x,t.y=s.y,t}function nt(t,e){var n=tt(e[0].radius,e[0].angle,t),i=tt(e[0].radius,e[1].angle,t);return"M "+K(n)+","+Q(n)+" A "+e[0].radius+","+e[0].radius+" 0,0, "+(e[1].angle>e[0].angle?1:0)+" "+K(i)+","+Q(i)+" L "+K(e[1])+","+Q(e[1])}function it(t,e,n){var i=tt(t.target.radius+(t.source.radius-t.target.radius)*e,t.target.angle,n);return{x:K(i),y:Q(i)}}var at=c.line().x((function(t){return K(t)})).y((function(t){return Q(t)})).curve(c.curveStepBefore);function rt(t,e){return{x:K(t.target)+(K(t.source)-K(t.target))*e,y:Q(t.target)}}function st(t){return t.tag||!1}function ot(t,e){return t[e]||!1}var lt={"tree-container":"phylotree-container","tree-scale-bar":"tree-scale-bar",node:"node","internal-node":"internal-node","tagged-node":"node-tagged","selected-node":"node-selected","collapsed-node":"node-collapsed","root-node":"root-node",branch:"branch","selected-branch":"branch-selected","tagged-branch":"branch-tagged","tree-selection-brush":"tree-selection-brush","branch-tracer":"branch-tracer",clade:"clade",node_text:"phylotree-node-text"};function ct(t){return arguments.length?(this.options["internal-names"]=t,this):this.options["internal-names"]}function ht(t){return arguments.length?(this.options["is-radial"]=t,this):this.options["is-radial"]}function dt(t){return arguments.length?(this.options["align-tips"]=t,this):this.options["align-tips"]}function ut(t){return this.options["draw-size-bubbles"]&&this.options["bubble-styler"]?this.options["bubble-styler"](t):this.options["draw-size-bubbles"]?this.relative_nodeSpan(t)*this.scales[0]*.25:0}function pt(t){return this.options["is-radial"]?[("end"==t.text_align?-1:1)*(this.radius_pad_for_bubbles-t.radius),0]:(this.options["right-to-left"],[this.right_most_leaf-t.screen_x,0])}function _t(t){return arguments.length?(this.layout_listener_handler=t,this):this.layout_listener_handler}function ft(t){return arguments.length?(this.selection_attribute_name=t,this.syncEdgeLabels(),this):this.selection_attribute_name}function gt(t){return arguments.length?(gt="string"==typeof t&&"equal"==t?function(t){return 1}:t,this):gt}var mt={all:function(t){return!0},none:function(t){return!1},"all-leaf-nodes":function(t){return x(t.target)},"all-internal-nodes":function(t){return!x(t.target)}};function vt(t){return t?(this.selectionCallback=t,this):this.selectionCallback}var bt=Object.freeze({__proto__:null,css_classes:lt,internalNames:ct,radial:ht,alignTips:dt,nodeBubbleSize:ut,shiftTip:pt,layoutHandler:_t,selectionLabel:ft,get nodeSpan(){return gt},predefined_selecters:mt,selectionCallback:vt});function yt(t){return this.radial()?[("end"==t.text_align?-1:1)*(this.radius_pad_for_bubbles-t.radius),0]:(this.options["right-to-left"],[this.right_most_leaf-t.screen_x,0])}function xt(t,e,n){var i=this;t=c.select(t);var a=x(e);a&&(t=t.attr("data-node-name",e.data.name));var r=t.selectAll("text").data([e]),s=t.selectAll("line");if(a||this.showInternalName(e)&&!Lt(e))if(r=r.enter().append("text").classed(this.css_classes.node_text,!0).merge(r).on("click",(function(t){i.handle_node_click(e,t)})).attr("dy",(function(t){return.33*i.shown_font_size})).text((function(t){return i.options["show-labels"]?i._nodeLabel(t):""})).style("font-size",(function(t){return i.ensure_size_is_in_px(i.shown_font_size)})),r=this.radial()?r.attr("transform",(function(t){return i.d3PhylotreeSvgRotate(t.text_angle)+i.d3PhylotreeSvgTranslate(i.alignTips()?i.shiftTip(t):null)})).attr("text-anchor",(function(t){return t.text_align})):r.attr("text-anchor","start").attr("transform",(function(t){return"right-to-left"==i.options.layout?i.d3PhylotreeSvgTranslate([-20,0]):i.d3PhylotreeSvgTranslate(i.alignTips()?i.shiftTip(t):null)})),this.alignTips()?(s=s.data([e]),n?s=s.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(s).attr("x1",(function(t){return("end"==t.text_align?-1:1)*i.nodeBubbleSize(e)})).attr("x2",0).attr("y1",0).attr("y2",0).attr("x2",(function(t){return"right-to-left"==i.options.layout?t.screen_x:i.shiftTip(t)[0]})).attr("transform",(function(t){return i.d3PhylotreeSvgRotate(t.text_angle)})).attr("x2",(function(t){return"right-to-left"==i.options.layout?t.screen_x:i.shiftTip(t)[0]})).attr("transform",(function(t){return i.d3PhylotreeSvgRotate(t.text_angle)})):(s=s.enter().append("line").classed(this.css_classes["branch-tracer"],!0).merge(s).attr("x1",(function(t){return("end"==t.text_align?-1:1)*i.nodeBubbleSize(e)})).attr("y2",0).attr("y1",0).attr("x2",(function(t){return i.shiftTip(t)[0]}))).attr("transform",(function(t){return i.d3PhylotreeSvgRotate(t.text_angle)}))):s.remove(),this.options["draw-size-bubbles"]){var o=this.nodeBubbleSize(e);t.selectAll("circle").data([o]).enter().append("circle").attr("r",(function(t){return t})),this.shown_font_size>=5&&(r=r.attr("dx",(function(t){return("end"==t.text_align?-1:1)*((i.alignTips()?0:o)+.33*i.shown_font_size)})))}else this.shown_font_size>=5&&(r=r.attr("dx",(function(t){return("end"==t.text_align?-1:1)*i.shown_font_size*.33})));if(!a){var l=t.selectAll("circle").data([e]).enter().append("circle"),h=this.node_circle_size()(e);h>0?l.merge(l).attr("r",(function(t){return Math.min(.75*i.shown_font_size,h)})).on("click",(function(t){i.handle_node_click(e,t)})):l.remove()}return this.node_styler&&this.node_styler(t,e),e}function wt(){for(var t=this.phylotree.nodes.descendants(),e=t.length-1;e>=0;e-=1)x(t[e])?t[e].hasHiddenNodes=t[e].notshown:t[e].hasHiddenNodes=t[e].children.reduce((function(t,e){return e.notshown||t}),!1);return this}function kt(t){var e=this.internalNames();return!!e&&("function"===typeof e?e(t):e)}function Nt(t){return arguments.length?(this.nodeSpan="string"==typeof t&&"equal"==t?function(t){return 1}:t,this):this.nodeSpan}function zt(t){var e=lt[x(t)?"node":"internal-node"];return st(t)&&(e+=" "+lt["tagged-node"]),ot(t,this.selection_attribute_name)&&(e+=" "+lt["selected-node"]),t.parent||(e+=" "+lt["root-node"]),(Lt(t)||St(t))&&(e+=" "+lt["collapsed-node"]),e}function Et(t){return!(t.hidden||t.notshown)}function Mt(t){return t.notshown}function St(t){return t.hasHiddenNodes||!1}function Lt(t){return t.collapsed||!1}function At(t){return[t.node,t["internal-node"],t["collapsed-node"],t["tagged-node"],t["root-node"]].reduce((function(t,e,n,i){return t+"g."+e+(n<i.length-1?",":"")}),"")}function Ot(t,e){var n=this;this.phylotree.clearInternalNodes(e);for(var i=this.phylotree.nodes.descendants().length-1;i>=0;i--){var a=this.phylotree.nodes.descendants()[i];x(a)||ot(a,this.selection_attribute_name)||(a[this.selection_attribute_name]=t(a.children))}this.modifySelection((function(t,e){return x(t.target),t.target[n.selection_attribute_name]}))}function Tt(t){return x(t=t.data)?t.name||"":this.showInternalName(t)?t.name:""}function jt(t){return arguments.length?(this._nodeLabel=t||Tt,this.update(),this):this._nodeLabel}var Ct=Object.freeze({__proto__:null,shiftTip:yt,drawNode:xt,updateHasHiddenNodes:wt,showInternalName:kt,nodeSpan:Nt,reclassNode:zt,nodeVisible:Et,nodeNotshown:Mt,hasHiddenNodes:St,isNodeCollapsed:Lt,nodeCssSelectors:At,internalLabel:Ot,defNodeLabel:Tt,nodeLabel:jt});function Pt(t){return[t.clade].reduce((function(t,e,n,i){return t+"path."+e+(n<i.length-1?",":"")}),"")}function Rt(t){var e=this.svg.selectAll("."+this.css_classes["tree-container"]),n=0,i=e.selectAll(Pt(this.css_classes)).data(this.phylotree.nodes.descendants().filter(Lt),(function(t){return t.id||(t.id=++n)})),a=function(){},r=h.noop();this.radial()?(a=c.line().curve(c.curveBasis).y((function(t){return t[0]})).x((function(t){return t[1]})),r=function(t,e,n,i,a){return e?[n.screen_y+(t[0]-i)/50,n.screen_x+(t[1]-a)/50]:[n.screen_y,n.screen_x]}):(a=c.line().y((function(t){return t[0]})).x((function(t){return t[1]})).curve(c.curveBasis),r=function(t,e,n,i,a){return e?[n.screen_y+(t[0]-i)/50,n.screen_x+(t[1]-a)/50]:[n.screen_y,n.screen_x]}),i.exit().each((function(t){t.collapsed_clade=null})).remove(),t?i.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(i).attr("d",(function(t){if(t.collapsed_clade)return t.collapsed_clade;var e=t.collapsed[0][0],n=t.collapsed[0][1];return a(t.collapsed.map((function(i,a){return r(i,a,t,e,n)})))})).attr("d",(function(t){return t.collapsed_clade=a(t.collapsed)})):i.enter().insert("path",":first-child").attr("class",this.css_classes.clade).merge(i).attr("d",(function(t){return t.collapsed_clade?t.collapsed_clade:t.collapsed_clade=a(t.collapsed)}))}var Bt=Object.freeze({__proto__:null,cladeCssSelectors:Pt,updateCollapsedClades:Rt});function Ht(t,e,n){var i=this;t=(t=c.select(t)).attr("class",(function(t){return i.reclassEdge(t)})).on("click",(function(t){i.modifySelection([e.target],i.selection_attribute_name),i.update()}));var a=this.draw_branch([e.source,e.target]);n?(t.datum().existing_path&&(t=t.attr("d",(function(t){return t.existing_path}))),t=t.attr("d",a)):t=t.attr("d",a),e.existing_path=a;var r=this.phylotree.branch_length_accessor(e.target);if(void 0!==r){var s=t.selectAll("title");s.empty()&&(s=t.append("title")),s.text("Length = "+r)}else t.selectAll("title").remove();return this.edge_styler&&this.edge_styler(t,e,n),this.phylotree}function It(t){var e=lt.branch;return st(t)&&(e+=" "+lt["tagged-branch"]),ot(t,this.selection_attribute_name)&&(e+=" "+lt["selected-branch"]),e}function Ut(){this.links.forEach((function(t){t.target.data.annotation&&(t.target[t.target.data.annotation]=t.target.data.annotation)}))}function Dt(){var t=this;if(this.links.forEach((function(e){e[t.selection_attribute_name]=e.target[t.selection_attribute_name]||!1,e.tag=e.target.tag||!1})),this.countHandler()){var e={};e[this.selection_attribute_name]=this.links.reduce((function(e,n){return e+(n[t.selection_attribute_name]?1:0)}),0),e.tagged=this.links.reduce((function(t,e){return t+(st(e)?1:0)}),0),this.countUpdate(this,e,this.countHandler())}}function Ft(t){return!(t.target.hidden||t.target.notshown)}function qt(t){return[t.branch,t["selected-branch"],t["tagged-branch"]].reduce((function(t,e,n,i){return t+"path."+e+(n<i.length-1?",":"")}),"")}function Vt(t,e){return this.edge_placer(t,e)}var Xt=Object.freeze({__proto__:null,drawEdge:Ht,reclassEdge:It,initializeEdgeLabels:Ut,syncEdgeLabels:Dt,edgeVisible:Ft,edgeCssSelectors:qt,placeAlongAnEdge:Vt}),Gt="phylotree.event";function Wt(t){return t.collapsed?(t.collapsed=!1,function t(e){x(e)||e.collapsed||e.children.forEach(t),e.hidden=!1}(t)):t.collapsed=!0,this.placenodes(),this}function $t(t,e,n){var i=this.size;if(this.radial()){var a=this.pad_width(),r="fit-to-size"!=this.options["top-bottom-spacing"]?this.pad_height():0;i=[i[1]+2*a,i[0]+2*a+r],e&&e.selectAll("."+lt["tree-container"]).attr("transform","translate ("+a+","+(a+r)+")")}else i=[i[0]+("fit-to-size"!=this.options["top-bottom-spacing"]?this.pad_height():0),i[1]+("fit-to-size"!=this.options["left-right-spacing"]?this.pad_width():0)];return e&&(n&&(e=e.transition(100)),e.attr("height",i[0]).attr("width",i[1])),this.size=i,i}function Yt(t,e){(e=e||"y_scaled")in this&&(this[e]*=t)}function Zt(t){var e=new CustomEvent(Gt,{detail:["refresh",t]});document.dispatchEvent(e)}function Jt(t,e){var n=new CustomEvent(Gt,{detail:["countUpdate",e,t.countHandler()]});document.dispatchEvent(n)}function Kt(t){var e=new CustomEvent(Gt,{detail:["layout",t,t.layoutHandler()]});document.dispatchEvent(e)}function Qt(t){switch(t.detail[0]){case"refresh":t.detail[1].refresh();break;case"countUpdate":case"layout":t.detail[2](t.detail[1])}return!0}function te(){document.addEventListener(Gt,Qt,!1)}function ee(t){return!t||null===t[0]&&null===t[1]?"":"translate ("+(null!==t[0]?t[0]:0)+","+(null!==t[1]?t[1]:0)+") "}function ne(t){return null!==t?"rotate ("+t+") ":""}var ie=Object.freeze({__proto__:null,toggleCollapse:Wt,resizeSvg:$t,rescale:Yt,triggerRefresh:Zt,countUpdate:Jt,d3PhylotreeTriggerLayout:Kt,d3PhylotreeEventListener:Qt,d3PhylotreeAddEventListener:te,d3PhylotreeSvgTranslate:ee,d3PhylotreeSvgRotate:ne}),ae="d3_layout_phylotree_context_menu";function re(t,e,n,i,a){var r=this,s=c.select(e).select("#"+ae);if(s.empty()&&(s=c.select(e).append("div").attr("id",ae).attr("class","dropdown-menu").attr("role","menu")),s.selectAll("a").remove(),s.selectAll("h6").remove(),s.selectAll("div").remove(),t){if(!h.some([Boolean(t.menu_items),i.hide,i.selectable,i.collapsible])||!i["show-menu"])return;x(t)||(i.collapsible&&(s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(Lt(t)?"Expand Subtree":"Collapse Subtree").on("click",(function(e){s.style("display","none"),r.toggleCollapse(t).update()})),i.selectable&&(s.append("div").attr("class","dropdown-divider"),s.append("h6").attr("class","dropdown-header").text("Toggle selection"))),i.selectable&&(s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All descendant branches").on("click",(function(e){s.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!0))})),s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All terminal branches").on("click",(function(e){s.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!1))})),s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("All internal branches").on("click",(function(e){s.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!1,!0))})))),t.parent&&(i.selectable&&(s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Incident branch").on("click",(function(e){s.style("display","none"),n.modifySelection([t])})),s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Path to root").on("click",(function(e){s.style("display","none"),r.modifySelection(r.phylotree.pathToRoot(t))})),(i.reroot||i.hide)&&s.append("div").attr("class","dropdown-divider")),i.reroot&&s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Reroot on this node").on("click",(function(e){s.style("display","none"),r.phylotree.reroot(t),r.update()})),i.hide&&s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Hide this "+(x(t)?"node":"subtree")).on("click",(function(e){s.style("display","none"),r.modifySelection([t],"notshown",!0,!0).updateHasHiddenNodes().update()}))),St(t)&&s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text("Show all descendant nodes").on("click",(function(e){s.style("display","none"),n.modifySelection(n.selectAllDescendants(t,!0,!0),"notshown",!0,!0,"false").updateHasHiddenNodes().update()}));var o=[];if("menu_items"in t&&"object"===typeof t.menu_items&&t.menu_items.forEach((function(e){3==e.length&&(e[2]&&!e[2](t)||o.push([e[0],e[1]]))})),o.length){var l=[i.hide,i.selectable,i.collapsible];h.some(l)&&s.append("div").attr("class","dropdown-divider"),o.forEach((function(e){s.append("a").attr("class","dropdown-item").attr("tabindex","-1").text(constant(e[0])(t)).on("click",h.partial(e[1],t))}))}var d=document.querySelector(e).getBoundingClientRect();s.style("position","absolute").style("left",a.clientX-d.x+12+"px").style("top",a.clientY-d.y+"px").style("display","block")}else s.style("display","none")}function se(t,e,n,i){"menu_items"in t||(t.menu_items=[]),t.menu_items.some((function(t){return t[0]==e&&t[1]==n&&t[2]==i}))||t.menu_items.push([e,n,i])}function oe(t,e,n,i,a){if(e=e||this.selection_attribute_name,a=a||"toggle",this.options["restricted-selectable"].length){if(!h.contains(h.keys(mt),t))return;t=mt[t]}if(!this.options["restricted-selectable"]&&!this.options.selectable||this.options["binary-selectable"])this.options["binary-selectable"]&&("function"===typeof t?this.links.forEach((function(n){var i=t(n);n[e]=n[e]||!1,n[e]!=i&&(n[e]=i,s=!0,n.target[e]=i),this.options["attribute-list"].forEach((function(t){t!=e&&!0===n[e]&&(n[t]=!1,n.target[t]=!1)}))})):(t.forEach((function(t){var n;n=!t[e],t[e]!=n&&(t[e]=n,s=!0)})),this.links.forEach((function(t){t[e]=t.target[e],this.options["attribute-list"].forEach((function(n){n!=e&&!0!==t[e]&&(t[n]=!1,t.target[n]=!1)}))}))),s&&(i||Zt(this),this.countHandler()&&((r={})[e]=this.links.reduce((function(t,n){return t+(n[e]?1:0)}),0),this.countUpdate(this,r,this.countHandler())),n&&this.placenodes()));else{var r,s=!1;"function"===typeof t?this.links.forEach((function(n){var i=t(n);n[e]=n[e]||!1,n[e]!=i&&(n[e]=i,s=!0,n.target[e]=i)})):(t.forEach((function(t){var n;switch(a){case"true":n=!0;break;case"false":n=!1;break;default:n=!t[e]}t[e]!=n&&(t[e]=n,s=!0)})),this.links.forEach((function(t){t[e]=t.target[e]}))),s&&(i||Zt(this),this.countHandler&&((r={})[e]=this.links.reduce((function(t,n){return t+(n[e]?1:0)}),0),Jt(this,r,this.countHandler)),n&&this.placenodes())}return this.selectionCallback&&"tag"!=e&&this.selectionCallback(this.getSelection()),this.refresh(),this.update(),this}function le(){var t=this;return this.nodes.filter((function(e){return e[t.selection_attribute_name]}))}function ce(t,e,n){var i=[];function a(r){x(r)?e&&r!=t&&i.push(r):(n&&r!=t&&i.push(r),r.children.forEach(a))}return a(t),i}function he(t){return t?(this.selectionCallback=t,this):this.selectionCallback}var de=Object.freeze({__proto__:null,nodeDropdownMenu:re,addCustomMenu:se,modifySelection:oe,getSelection:le,selectAllDescendants:ce,selectionCallback:he});function ue(t){return function(){return t}}var pe=function(){function t(e){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.css_classes=lt,this.phylotree=e,this.container=i.container,this.separation=function(t,e){return 0},this._nodeLabel=this.defNodeLabel,this.svg=null,this.selectionCallback=null,this.scales=[1,1],this.size=[1,1],this.fixed_width=[14,30],this.font_size=12,this.scale_bar_font_size=12,this.offsets=[0,this.font_size/2],this.draw_branch=at,this.draw_scale_bar=null,this.edge_placer=rt,this.count_listener_handler=function(){},this.layout_listener_handler=function(){},this.node_styler=void 0,this.edge_styler=void 0,this.shown_font_size=this.font_size,this.selection_attribute_name="selected",this.right_most_leaf=0,this.label_width=0,this.radial_center=0,this.radius=1,this.radius_pad_for_bubbles=0,this.rescale_nodeSpan=1,this.relative_nodeSpan=function(t){return this.nodeSpan(t)/this.rescale_nodeSpan};var r={layout:"left-to-right",logger:console,branches:"step",scaling:!0,bootstrap:!1,"color-fill":!0,"internal-names":!1,selectable:!0,"restricted-selectable":!1,collapsible:!0,"left-right-spacing":"fixed-step","top-bottom-spacing":"fixed-step","left-offset":0,"show-scale":"top","draw-size-bubbles":!1,"bubble-styler":this.radius_pad_for_bubbles,"binary-selectable":!1,"is-radial":!1,"attribute-list":[],"max-radius":768,"annular-limit":.38196601125010515,compression:.2,"align-tips":!1,"maximum-per-node-spacing":100,"minimum-per-node-spacing":2,"maximum-per-level-spacing":100,"minimum-per-level-spacing":10,node_circle_size:ue(3),transitions:null,brush:!0,reroot:!0,hide:!0,"label-nodes-with-name":!1,zoom:!1,"show-menu":!0,"show-labels":!0,"node-styler":null,"edge-styler":null,"node-span":null};this.ensure_size_is_in_px=function(t){return"number"===typeof t?t+"px":t},this.options=h.defaults(i,r),this.width=this.options.width||800,this.height=this.options.height||600,this.node_styler=this.options["node-styler"],this.edge_styler=this.options["edge-styler"],this.nodeSpan=this.options["node-span"],this.nodeSpan||(this.nodeSpan=function(t){return 1}),this.rescale_nodeSpan=this.phylotree.nodes.children.map((function(t){if(x(t)||n.showInternalName(t))return n.nodeSpan(t)})).reduce((function(t,e){return Math.min(e,t||1e200)}),null)||1,this.initialize_svg(this.container),this.links=this.phylotree.nodes.links(),this.initializeEdgeLabels(),this.update(),te()}return r(t,[{key:"pad_height",value:function(){return this.draw_scale_bar?this.scale_bar_font_size+25:0}},{key:"pad_width",value:function(){this.label_width=this._label_width(this.shown_font_size);var t=this.options["show-labels"]?this.label_width:0;return this.offsets[1]+this.options["left-offset"]+t}},{key:"collapse_node",value:function(t){Lt(t)||(t.collapsed=!0)}},{key:"set_size",value:function(t){if(!arguments.length)return this.size;var e=t;return"fixed-step"!=this.options["top-bottom-spacing"]&&(this.size[0]=e[0]),"fixed-step"!=this.options["left-right-spacing"]&&(this.size[1]=e[1]),this}},{key:"initialize_svg",value:function(t){var e=this;return this.svg!==t&&(c.select(t).select("svg").remove(),this.svg=c.create("svg").attr("width",this.width).attr("height",this.height),this.set_size([this.height,this.width]),"phylotree-container"==this.css_classes["tree-container"]&&(this.svg.selectAll("*").remove(),this.svg.append("defs")),c.select(this.container).on("click",(function(t){e.handle_node_click(null)}),!0)),this}},{key:"update_layout",value:function(t,e){e&&(this.nodes=c.hierarchy(t),this.nodes.each((function(t){t.id=null}))),this.update(),this.syncEdgeLabels()}},{key:"update",value:function(t){var e=this,n=this;this.placenodes(),t=this.transitions(t);var i=0,a=this.svg.selectAll("."+lt["tree-container"]).data([0]);if(a=a.enter().append("g").attr("class",lt["tree-container"]).merge(a).attr("transform",(function(t){return e.d3PhylotreeSvgTranslate([e.offsets[1]+e.options["left-offset"],e.pad_height()])})),this.draw_scale_bar){var r=this.svg.selectAll("."+lt["tree-scale-bar"]).data([0]);r.enter().append("g").attr("class",lt["tree-scale-bar"]).style("font-size",this.ensure_size_is_in_px(this.scale_bar_font_size)).merge(r).attr("transform",(function(t){return e.d3PhylotreeSvgTranslate([e.offsets[1]+e.options["left-offset"],e.pad_height()-10])})).call(this.draw_scale_bar),r.selectAll("text").style("text-anchor","end")}else this.svg.selectAll("."+lt["tree-scale-bar"]).remove();a=this.svg.selectAll("."+lt["tree-container"]).data([0]),this.updateCollapsedClades(t);var s=a.selectAll(qt(lt)).data(this.links.filter(Ft),(function(t){return t.target.id||(t.target.id=++i)}));s.exit().remove(),s=s.enter().insert("path",":first-child").merge(s).each((function(e){n.drawEdge(this,e,t)}));var o=a.selectAll(At(lt)).data(this.phylotree.nodes.descendants().filter(Et),(function(t){return t.id||(t.id=++i)}));if(o.exit().remove(),o=o.enter().append("g").attr("class",this.reclassNode).merge(o).attr("transform",(function(t){var n="right-to-left"==e.options.layout&&x(t);return t.screen_x=K(t),t.screen_y=Q(t),e.d3PhylotreeSvgTranslate([n?0:t.screen_x,t.screen_y])})).each((function(e){n.drawNode(this,e,t)})).attr("transform",(function(t){if(!h.isUndefined(t.screen_x)&&!h.isUndefined(t.screen_y))return"translate("+t.screen_x+","+t.screen_y+")"})),this.options["label-nodes-with-name"]&&(o=o.attr("id",(function(t){return"node-"+t.name}))),this.resizeSvg(this.phylotree,this.svg,t),this.options.brush){var l=a.selectAll("."+lt["tree-selection-brush"]).data([0]).enter().insert("g",":first-child").attr("class",lt["tree-selection-brush"]),d=c.brush().on("brush",(function(t){var n=c.event.selection,i=e.links.filter(Ft).filter((function(t,e){return t.source.screen_x>=n[0][0]&&t.source.screen_x<=n[1][0]&&t.source.screen_y>=n[0][1]&&t.source.screen_y<=n[1][1]&&t.target.screen_x>=n[0][0]&&t.target.screen_x<=n[1][0]&&t.target.screen_y>=n[0][1]&&t.target.screen_y<=n[1][1]})).map((function(t){return t.target}));e.modifySelection(e.phylotree.links.map((function(t){return t.target})),"tag",!1,i.length>0,"false"),e.modifySelection(i,"tag",!1,!1,"true")})).on("end",(function(){}));l.call(d)}if(this.syncEdgeLabels(),this.options.zoom){var u=c.zoom().scaleExtent([.1,10]).on("zoom",(function(t){c.select("."+lt["tree-container"]).attr("transform",(function(e){return t.transform})),c.select("."+lt["tree-scale-bar"]).attr("transform",(function(e){var n=t.transform;return n.y-=10,n}))}));this.svg.call(u)}return this}},{key:"_handle_single_node_layout",value:function(t){var e=this.nodeSpan(t)/this.rescale_nodeSpan;this.x=t.x=this.x+this.separation(this.last_node,t)+.5*(this.last_span+e),this._extents[1][1]=Math.max(this._extents[1][1],t.y),this._extents[1][0]=Math.min(this._extents[1][0],t.y-.5*e),this.is_under_collapsed_parent?this._extents[0][1]=Math.max(this._extents[0][1],this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span+(.5*e+this.separation(this.last_node,t))*this.options.compression):this._extents[0][1]=Math.max(this._extents[0][1],this.x+.5*e+this.separation(this.last_node,t)),this.last_node=t,this.last_span=e}},{key:"tree_layout",value:function(t){var e=this;if(!Mt(t)){var n=x(t);t.text_angle=null,t.text_align=null,t.radius=null,t.angle=null;var i=!1;if(t.parent)if(this.do_scaling){if(i)return 0;if(t.y=this.phylotree.branch_length_accessor(t),"undefined"===typeof t.y)return i=!0,0;t.y+=t.parent.y}else t.y=n?this.max_depth:t.depth;else this.x=0,t.y=0,this.last_node=null,this.last_span=0,this._extents=[[0,0],[0,0]];if(n&&this._handle_single_node_layout(t),!n)if(Lt(t)&&!this.is_under_collapsed_parent){if(this.save_x=this.x,this.save_span=.5*this.last_span,this.is_under_collapsed_parent=!0,this.process_internal_node(t),this.is_under_collapsed_parent=!1,"number"===typeof t.x){t.x=this.save_x+(t.x-this.save_x)*this.options.compression+this.save_span,t.collapsed=[[t.x,t.y]];var a=function n(i){i.hidden=!0,x(i)?(e.x=i.x=e.save_x+(i.x-e.save_x)*e.options.compression+e.save_span,t.collapsed.push([i.x,i.y])):i.children.map(n)};this.x=this.save_x,a(t),t.collapsed.splice(1,0,[this.save_x,t.y]),t.collapsed.push([this.x,t.y]),t.collapsed.push([t.x,t.y]),t.hidden=!1}}else this.process_internal_node(t);return t.x}}},{key:"process_internal_node",value:function(t){var e=0;if(this.showInternalName(t)){for(var n=t.children.length/2>>0,i=0,a=!1,r=0;r<t.children.length;r++)"number"==typeof this.tree_layout(t.children[r])&&i++,i>=n&&!a&&(this._handle_single_node_layout(t),a=!0);0==i?(t.notshown=!0,t.x=void 0):a||this._handle_single_node_layout(t)}else t.x=t.children.map(this.tree_layout.bind(this)).reduce((function(t,n){return"number"==typeof n?t+n:(e+=1,t)}),0),e==t.children.length?(t.notshown=!0,t.x=void 0):t.x/=t.children.length-e}},{key:"do_lr",value:function(t){if(this.radial()&&t&&(this.offsets[1]=0),"fixed-step"==this.options["left-right-spacing"])this.size[1]=this.max_depth*this.fixed_width[1],this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"])/this._extents[1][1],this.label_width=this._label_width(this.shown_font_size),this.radial()&&(this.label_width*=2);else{this.label_width=this._label_width(this.shown_font_size),t=!0;var e=this.size[1]-this.offsets[1]-this.options["left-offset"];.5*e<this.label_width&&(this.shown_font_size*=.5*e/this.label_width,this.label_width=.5*e),this.scales[1]=(this.size[1]-this.offsets[1]-this.options["left-offset"]-this.label_width)/this._extents[1][1]}}},{key:"placenodes",value:function(){var t=this;this._extents=[[0,0],[0,0]],this.x=0,this.last_span=0,this.last_node=null,this.last_span=0,this.save_x=this.x,this.save_span=.5*this.last_span,this.do_scaling=this.options.scaling;var e=!1;this.is_under_collapsed_parent=!1,this.max_depth=1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes,this.do_scaling),this.max_depth=c.max(this.phylotree.nodes.descendants(),(function(t){return t.depth})),this.do_scaling&&e&&(this.do_scaling=!1,this.phylotree.nodes.x=this.tree_layout(this.phylotree.nodes));var n=!1;if(this.draw_scale_bar=this.options["show-scale"]&&this.do_scaling,this.offsets[1]=Math.max(this.font_size,-this._extents[1][0]*this.fixed_width[0]),"fixed-step"==this.options["top-bottom-spacing"]?(this.size[0]=this._extents[0][1]*this.fixed_width[0],this.scales[0]=this.fixed_width[0]):(this.scales[0]=(this.size[0]-this.pad_height())/this._extents[0][1],n=!0),this.shown_font_size=Math.min(this.font_size,this.scales[0]),this.radial()){this.draw_branch=h.partial(nt,this.radial_center),this.edge_placer=it;var i=null,a=null,r=null,s=0,o=this._extents[0][1]*this.scales[0],l=function(t,e,n,i,a){return a=a||0,Math.sqrt((e-t)*(e-t)+2*(t+a)*(e+a)*(1-Math.cos(n-i)))},d=0;this.phylotree.nodes.each((function(e){var n=e.x*t.scales[0];e.angle=2*Math.PI*n/o,e.text_angle=e.angle-Math.PI/2,e.text_angle=e.text_angle>0&&e.text_angle<Math.PI,e.text_align=e.text_angle?"end":"start",e.text_angle=(e.text_angle?180:0)+180*e.angle/Math.PI})),this.do_lr(n),this.phylotree.nodes.each((function(e){e.radius=e.y*t.scales[1]/t.size[1],d=Math.max(e.radius,d)}));var u=0;this.phylotree.nodes.each((function(e){if(!e.children){var n=e.x*t.scales[0];if(null!==i){var o=n-a,c=l(e.radius,r,e.angle,i,u),h=c>0?o/c:10*t.options["max-radius"];if(h>t.options["max-radius"]){var p=o/t.options["max-radius"],_=e.radius+r,f=e.radius*r-(p*p-(r-e.radius)*(r-e.radius))/2/(1-Math.cos(i-e.angle)),g=Math.sqrt(_*_-4*f);u=Math.min(t.options["annular-limit"]*d,(-_+g)/2),s=t.options["max-radius"]}else s=Math.max(s,h)}i=e.angle,a=n,r=e.radius}})),this.radius=Math.min(this.options["max-radius"],Math.max(o/2/Math.PI,s)),n&&(this.radius=Math.min(this.radius,.5*(Math.min(o,this._extents[1][1]*this.scales[1])-this.label_width)-this.radius*u)),this.radial_center=this.radius_pad_for_bubbles=this.radius,this.draw_branch=h.partial(nt,this.radial_center);var p=1;u&&(p=d/(d+u),this.radius*=p),this.phylotree.nodes.each((function(e){if(et(e,t.radius,u,t.radial_center,t.scales,t.size),d=Math.max(d,e.radius),t.options["draw-size-bubbles"]?t.radius_pad_for_bubbles=Math.max(t.radius_pad_for_bubbles,e.radius+t.nodeBubbleSize(e)):t.radius_pad_for_bubbles=Math.max(t.radius_pad_for_bubbles,e.radius),e.collapsed){e.collapsed=e.collapsed.map((function(e){var n={};return n.x=e[0],n.y=e[1],[(n=et(n,t.radius,u,t.radial_center,t.scales,t.size)).x,n.y]}));var n=e.collapsed[1];e.collapsed=e.collapsed.filter((function(t,i){return i<3||i>e.collapsed.length-4||Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))>3&&(n=t,!0)}))}})),this.size[0]=this.radial_center+this.radius/p,this.size[1]=this.radial_center+this.radius/p}else this.do_lr(),this.draw_branch=at,this.edge_placer=rt,this.right_most_leaf=0,this.phylotree.nodes.each((function(e){if(e.x*=t.scales[0],e.y*=.8*t.scales[1],"right-to-left"==t.options.layout&&(e.y=t._extents[1][1]*t.scales[1]-e.y),x(e)&&(t.right_most_leaf=Math.max(t.right_most_leaf,e.y+t.nodeBubbleSize(e))),e.collapsed){e.collapsed.forEach((function(e){e[0]*=t.scales[0],e[1]*=.8*t.scales[1]}));var n=e.collapsed[1][0];e.collapsed=e.collapsed.filter((function(t,i){return i<3||i>e.collapsed.length-4||t[0]-n>3&&(n=t[0],!0)}))}}));if(this.draw_scale_bar){var _,f;if(this.radial()){if(f=Math.min(this.radius/5,50),(f=(_=Math.pow(10,Math.ceil(Math.log(this._extents[1][1]*f/this.radius)/Math.log(10))))*(this.radius/this._extents[1][1]))<30){var g=Math.ceil(30/f);f*=g,_*=g}}else _=this._extents[1][1],f=this.size[1]-this.offsets[1]-this.options["left-offset"]-this.shown_font_size;var m=c.scaleLinear().domain([0,_]).range([0,f]),v=c.format(".2f");if(this.draw_scale_bar=c.axisTop().scale(m).tickFormat((function(t){return 0===t?"":v(t)})),this.radial())this.draw_scale_bar.tickValues([_]);else{var b=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},y=m.ticks();y=y.length>1?y[1]:y[0],this.draw_scale_bar.ticks(Math.min(10,b(f/(this.shown_font_size*v(y).length*2),0)))}}else this.draw_scale_bar=null;return this}},{key:"spacing_x",value:function(t,e){return arguments.length?(this.fixed_width[0]!=t&&t>=this.options["minimum-per-node-spacing"]&&t<=this.options["maximum-per-node-spacing"]&&(this.fixed_width[0]=t,e||this.placenodes()),this):this.fixed_width[0]}},{key:"spacing_y",value:function(t,e){return arguments.length?(this.fixed_width[1]!=t&&t>=this.options["minimum-per-level-spacing"]&&t<=this.options["maximum-per-level-spacing"]&&(this.fixed_width[1]=t,e||this.placenodes()),this):this.fixed_width[1]}},{key:"_label_width",value:function(t){var e=this;t=t||this.shown_font_size;var n=0;return this.phylotree.nodes.descendants().filter(Et).forEach((function(i){var a=12+e._nodeLabel(i).length*t*.8;null!==i.angle&&(a*=Math.max(Math.abs(Math.cos(i.angle)),Math.abs(Math.sin(i.angle)))),n=Math.max(a,n)})),n}},{key:"font_size",value:function(t){return arguments.length?(this.font_size=void 0===t?12:t,this):this.font_size}},{key:"scale_bar_font_size",value:function(t){return arguments.length?(this.scale_bar_font_size=void 0===t?12:t,this):this.scale_bar_font_size}},{key:"node_circle_size",value:function(t,e){return arguments.length?(this.options.node_circle_size=ue(void 0===t?3:t),this):this.options.node_circle_size}},{key:"css",value:function(t){if(0===arguments.length)return this.css_classes;if(arguments.length>2){var e={};return e[t[0]]=t[1],this.css(e)}for(var n in lt)n in t&&t[n]!=lt[n]&&(lt[n]=t[n]);return this}},{key:"transitions",value:function(t){return void 0!==t?t:null!==this.options.transitions?this.options.transitions:this.phylotree.nodes.descendants().length<=300}},{key:"css_classes",value:function(t,e){if(!arguments.length)return this.css_classes;var n=!1;for(var i in lt)i in t&&t[i]!=this.css_classes[i]&&(n=!0,this.css_classes[i]=t[i]);return e&&n&&this.layout(),this}},{key:"layout",value:function(t){return this.svg?(this.svg.selectAll("."+this.css_classes["tree-container"]+",."+this.css_classes["tree-scale-bar"]+",."+this.css_classes["tree-selection-brush"]),this.d3PhylotreeTriggerLayout(this),this.update()):(this.d3PhylotreeTriggerLayout(this),this)}},{key:"handle_node_click",value:function(t,e){this.nodeDropdownMenu(t,this.container,this,this.options,e)}},{key:"refresh",value:function(){var t=this;if(this.svg){var e=this.svg.selectAll("."+this.css_classes["tree-container"]).selectAll(qt(this.css_classes)).attr("class",this.reclassEdge.bind(this));this.edge_styler&&e.each((function(e){t.edge_styler(c.select(t),e)}))}return this}},{key:"countHandler",value:function(t){return arguments.length?(this.count_listener_handler=t,this):this.count_listener_handler}},{key:"style_nodes",value:function(t){return arguments.length?(this.node_styler=t,this):this.node_styler}},{key:"style_edges",value:function(t){return arguments.length?(this.edge_styler=t.bind(this),this):this.edge_styler}},{key:"itemSelected",value:function(t,e){return t[e]||!1}},{key:"show",value:function(){return this.svg.node()}}]),t}();function _e(t,e,n){return this.nodes.sum((function(t){return t.value})).sort(t),this.display&&(this.display.update_layout(this.nodes),this.display.update()),this}function fe(){var t,e;return t=(t=1==arguments.length?arguments[0]:Array.from(arguments)).map((function(t){return"string"==typeof t?t:t.name})),this.traverse_and_compute((function(n){n.children?n.parent?(n.mrca=h.union.apply(h,i(n.descendants().map((function(t){return t.mrca})))),e||n.mrca.length!=t.length||(e=n)):e||(e=n):n.mrca=h.intersection([n.name],t)})),e}h.extend(pe.prototype,Bt),h.extend(pe.prototype,Ct),h.extend(pe.prototype,Xt),h.extend(pe.prototype,ie),h.extend(pe.prototype,de),h.extend(pe.prototype,bt);var ge=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.newick_string="",this.nodes=[],this.links=[],this.parsed_tags=[],this.partitions=[],this.branch_length_accessor=q,this.branch_length=q,this.logger=n.logger||console,this.selection_attribute_name="selected";var i=n.type||void 0,r=[],s=this;if(h.isString(i))i in C?r=C[i](e,n):s.logger.error("type "+i+" not in registry! Available types are "+h.keys(C));else if(h.isFunction(i))try{r=i(e,n)}catch(l){s.logger.error("Could not parse custom format!")}else"root"==e.name?r={json:e,error:null}:"string"!=typeof e?r=e:"application/xml"==e.contentType?r=T(e):(this.newick_string=e,r=z(e,n));if(r.json){s.nodes=c.hierarchy(r.json);var o={};s.nodes.each((function(t){t.data.annotation&&(o[t.data.annotation]=!0)})),s.parsed_tags=Object.keys(o)}else s.nodes=[];return s.links=s.nodes.links(),this.hasBranchLengths()||(console.warn("Phylotree User Warning : NO BRANCH LENGTHS DETECTED, SETTING ALL LENGTHS TO 1"),this.setBranchLength((function(t){return 1}))),s}return r(t,[{key:"json",value:function(t){var e=0;this.traverse_and_compute((function(t){t.json_export_index=e++}),t);var n=new Array(e);return e=0,this.traverse_and_compute((function(t){var i=h.clone(t);delete i.json_export_index,t.parent&&(i.parent=t.parent.json_export_index),t.children&&(i.children=h.map(t.children,(function(t){return t.json_export_index}))),n[e++]=i}),t),this.traverse_and_compute((function(t){delete t.json_export_index}),t),JSON.stringify(n)}},{key:"traverse_and_compute",value:function(t,e,n,i){function a(e){h.isUndefined(e)||B(e,t,i)}function r(e){H(e,t,i)}function s(e){I(e,t,i)}return(e="pre-order"==(e=e||"post-order")?r:"in-order"==e?s:a)(n||this.nodes),this}},{key:"get_parsed_tags",value:function(){return this.parsed_tags}},{key:"update",value:function(t){this.nodes=t}},{key:"render",value:function(t){return this.display=new pe(this,t),this.display}}]),t}();function me(t){var e=t.branch_length_accessor;if(!e)throw"A non-null branch lengths accessor function is required for this operation";var n=0;function i(t){for(var e=0;e<t.children.length;e++)for(var n=0;n<t.children.length;n++)e!=n&&h.each(t.children[n].cot_path_to_leaves_below,(function(i,a){t.children[e].cot_path_to_leaves_above&&(t.children[e].cot_path_to_leaves_above[a]=i+t.children[n].cot_computed_length)}))}return t.traverse_and_compute((function(i){if(i.cot_computed_length=e(i),i.parent&&h.isUndefined(i.cot_computed_length))throw"Non-null branch lengths are required for this operation: missing branch length at node "+i.data.name;t.isLeafNode(i)?(i.cot_leaf_index=n++,i.cot_path_to_leaves_below={},i.cot_path_to_leaves_below[i.cot_leaf_index]=0,i.cot_path_to_leaves_above={}):(i.cot_path_to_leaves_below={},i.cot_path_to_leaves_above={})})),t.traverse_and_compute((function(t){t.parent&&h.each(t.cot_path_to_leaves_below,(function(e,n){t.parent.cot_path_to_leaves_below[n]=e+t.cot_computed_length}))})),i(t.getRootNode()),t.traverse_and_compute((function(e){e.parent&&(h.each(e.parent.cot_path_to_leaves_above,(function(t,n){e.cot_path_to_leaves_above[n]=t+e.parent.cot_computed_length})),t.isLeafNode(e)||i(e))}),"pre-order"),n}function ve(t){var e=t.getTips(),n=h.map(e,(function(t){return t.depth}));return h.reduce(n,(function(t,e){return t+e}),0)}function be(t,e){e=e||2;var n=me(t),i=Number.MAX_VALUE,a=0,r=null;return 2==e?t.traverse_and_compute((function(t){if(t.parent){var e=0,s=0,o=0,l=0,c=0;h.each(t.cot_path_to_leaves_below,(function(t){e+=t,s+=t*t,c++})),h.each(t.cot_path_to_leaves_above,(function(t){o+=t,l+=t*t}));var d=n-c,u=(o-e+t.cot_computed_length*d)/n;u<0?u=0:u>t.cot_computed_length&&(u=t.cot_computed_length);var p=l+s+2*(o*(t.cot_computed_length-u)+e*u)+c*u*u+(t.cot_computed_length-u)*(t.cot_computed_length-u)*d;p<i&&(r=t,a=u/t.cot_computed_length,i=p),delete t.cot_computed_length,delete t.cot_path_to_leaves_below,delete t.cot_path_to_leaves_above,delete t.cot_leaf_index}})):t.traverse_and_compute((function(t){if(t.parent)for(var n=t.cot_computed_length>0?.05*t.cot_computed_length:.1,s=0;s<t.cot_computed_length;){var o=0;h.each(t.cot_path_to_leaves_below,(function(t){o+=Math.pow(t+s,e)})),h.each(t.cot_path_to_leaves_above,(function(n){o+=Math.pow(n+(t.cot_computed_length-s),e)})),o<i&&(r=t,a=s/t.cot_computed_length,i=o),s+=n}})),{location:r,breakpoint:a,distance:i}}function ye(t){if(!t.hasBranchLengths())throw"Center of tree calculation cannot be performed on trees that do not have fully specified branch lengths";var e=t.branch_length;t.traverse_and_compute((function(n){if(n.parent){var i,a=e(n);t.isLeafNode(n)?(i=n,n.max_path=0,n.max_path_terminus=n):(a+=n.max_path,i=n.max_path_terminus),(!n.parent.max_path||n.parent.max_path<a)&&(n.parent.max_path=a,n.parent.max_path_terminus=i)}}));var n=t.getRootNode(),i=0;if(n.children.forEach((function(t){if(t.max_path_terminus!==n.max_path_terminus){var a=t.max_path+e(t);a>=i&&(i=a)}})),n.max_path>i){i=.5*(i+n.max_path);for(var a=n.max_path_terminus;;){var r=e(a);if(!(r<=i))return{location:a,breakpoint:i/r};i-=r,a=a.parent}}return{location:n,breakpoint:0}}function xe(t){t.traverse_and_compute((function(e){t.isLeafNode(e)&&(e.data.copy_number=1)}))}function we(t,e,n,i,a){var r=t.branch_length(e),s=!1;if(n||(i=e.data.rootToTip,a=0,s=!0),e.children)for(var o=0;o<e.children.length;o++)e.children[o]!=n?we(t,e.children[o],e,i,a):s=!0;e.data.rtta=e.data.rootToTip-i+a,s&&(i-=r,a+=r),e.parent&&s&&we(t,e.parent,e,i,a)}function ke(t){var e=[],n=0,i=0;xe(t),ze(t),t.traverse_and_compute((function(n){t.isLeafNode(n)&&!h.isNull(n.data.decimal_date_value)&&e.push([n.data.decimal_date_value,n.data.rtta,n.data.copy_number])}));var a=Ne(e);return t.traverse_and_compute((function(r){if(t.isLeafNode(r)&&!h.isNull(r.data.decimal_date_value)){we(t,r,null,0,0),e=[],t.traverse_and_compute((function(n){t.isLeafNode(n)&&!h.isNull(n.data.decimal_date_value)&&e.push([n.data.decimal_date_value,n.data.rtta,n.data.copy_number])}));var s=Ne(e),o=s.r2;o>n&&(n=o,i=r,a=s)}})),{root:i,fit:a}}function Ne(t){var e=t.reduce((function(t,e){return e[2]+t}),0),n=t.reduce((function(t,e){return e[2]*e[0]+t}),0),i=t.reduce((function(t,e){return e[2]*e[1]+t}),0),a=n/e,r=i/e,s=0,o=0,l=0;t.forEach((function(t){var e=t[0]-a;o+=t[2]*e*e,s+=t[2]*e*t[1],l+=t[2]*(t[1]-r)*(t[1]-r)}));var c=(i-n*(s/=o))/e,h=0;return t.forEach((function(t){var e=t[1]-c-s*t[0];h+=t[2]*e*e})),{intercept:c,slope:s,r2:1-h/l,"var (intercept)":Math.sqrt((1+n*n/(e*o))/e),"var (slope)":Math.sqrt(1/o)}}function ze(t){var e=t.branch_length_accessor,n=0;t.traverse_and_compute((function(i){if(i.parent&&(i.data._computed_length=e(i),!h.isNumber(i.data._computed_length)))throw"rootToTip cannot be run on trees with missing branch lengths";t.isLeafNode(i)&&(i.data.leaf_index=n++),"r2t"in i.data&&delete i.data.r2t})),t.traverse_and_compute((function(e){e.parent&&("r2t"in e.parent.data||(e.parent.data.r2t={}),t.isLeafNode(e)?e.parent.data.r2t[e.data.leaf_index]=e.data._computed_length:(h.each(e.data.r2t,(function(t,n){e.parent.data.r2t[n]=t+e.data._computed_length})),delete e.data.r2t),delete e.data._computed_length)}));var i=t.getRootNode().data.r2t;return t.traverse_and_compute((function(e){t.isLeafNode(e)&&(e.data.rootToTip=i[e.data.leaf_index]||0,delete e.data.leaf_index)})),delete t.getRootNode().data.r2t,t}ge.prototype.isLeafNode=x,ge.prototype.mrca=fe,ge.prototype.hasBranchLengths=D,ge.prototype.getBranchLengths=F,ge.prototype.branchName=W,ge.prototype.normalizeBranchLengths=X,ge.prototype.scaleBranchLengths=G,ge.prototype.getNewick=E,ge.prototype.resortChildren=_e,ge.prototype.setBranchLength=V,ge.prototype.maxParsimony=R,ge.prototype.getTipLengths=P,ge.prototype.leftChildRightSibling=U,h.extend(ge.prototype,N),h.extend(ge.prototype,J),h.extend(ge.prototype,A);var Ee=c.timeParse("%Y%m%d"),Me=/([0-9]{4}).?([0-9]{2}).?([0-9]{2})$/g,Se=function(t){if(c.layout.phylotree.isLeafNode(t)&&"name"in t){var e=Me.exec(t.name);if(e)return e[1]+e[2]+e[3]}return null},Le=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ee;return e=e||Se,t.traverse_and_compute((function(t){var i=e(t);if(i)try{t.data.date_value=n(i);var a=t.data.date_value.getFullYear(),r=new Date(a,0,1),s=new Date(a+1,0,1);return void(t.data.decimal_date_value=a+(t.data.date_value-r)/(s-r))}catch(o){}t.data.date_value=null,t.data.decimal_date_value=null})),t};function Ae(t,e,n,i,a){i=i||t.getRootNode(),a=h.isNumber(a)?a:1;var r=t.branch_length;t.traverse_and_compute((function(t){if(t.parent){if(t._computed_length=r(t),!h.isNumber(t._computed_length))throw"clusterPicker cannot be run on trees with missing branch lengths";t.max_path_length=0}})),t.traverse_and_compute((function(t){t.parent&&(t.parent.max_path_length=Math.max(t.parent.max_path_length,t.max_path_length+t._computed_length))}));var s=[];return t.traverse_and_compute(h.noop,"pre-order",i,(function(i){if(!t.isLeafNode(i)){var r=h.isString(i.data.bootstrap_values)?+i.data.bootstrap_values:a;if(r>=e){var o=h.reduce(i.children,(function(t,e){return e.max_path_length+e._computed_length+t}),0);if(o<=n)return s.push({root:i,diameter:o,bootstrap:r}),!0}}return!1})),t.traverse_and_compute((function(t){t.parent&&(delete t._computed_length,delete t.max_path_length)}),"post-order",i),h.each(s,(function(e){e.members=[],t.traverse_and_compute((function(n){t.isLeafNode(n)&&e.members.push(n)}),"post-order",e.root)})),s}function Oe(t,e,n,i,a){i=h.isNumber(i)?i:1;var r=me(t),s=t.getRootNode().children[0],o=Number.MAX_VALUE,l=Number.MAX_VALUE;if(!(n>0&&n<1))throw"Invalid percentile threshold in perform_phylopart";t.traverse_and_compute((function(e){t.isLeafNode(e)&&(e.cot_computed_length<o?(o<l&&(l=o),o=e.cot_computed_length):e.cot_computed_length<l&&(l=e.cot_computed_length))})),o+=l;var c=h.reduce(s.cot_path_to_leaves_below,(function(t,e){return e>t?e:t}),0)+h.reduce(s.cot_path_to_leaves_above,(function(t,e){return e>t?e:t}),0)+s.cot_computed_length-o;h.isUndefined(a)&&(a=Math.min(.001,c/100));var d=1+(c/a>>0);d>500&&(a=c/(d=500));var u=t.getRootNode();u.paths_to_leaves=new Array(r),h.each(u.children,(function(t){h.each(u.cot_path_to_leaves_below,(function(e,n){u.paths_to_leaves[n]=e+t.cot_computed_length}))})),t.traverse_and_compute((function(e){if(!t.isLeafNode(e)){e.histogram=new Array(d);for(var n=0;n<d;n++)e.histogram[n]=0;if(e.parent){var i=0;e.paths_to_leaves=[],h.each(e.cot_path_to_leaves_below,(function(t,n){e.paths_to_leaves[i++]=t}))}}delete e.cot_path_to_leaves_above,delete e.cot_path_to_leaves_below})),t.traverse_and_compute((function(e){if(!t.isLeafNode(e)){for(var n=0;n<e.paths_to_leaves.length;n++)for(var i=n+1;i<e.paths_to_leaves.length;i++){var r=e.paths_to_leaves[n]+e.paths_to_leaves[i];e.histogram[(r-o)/a>>0]++}e.leaf_count=e.paths_to_leaves.length,delete e.paths_to_leaves}}));for(var p=(r-1)*r/2*n,_=0;_<d-1&&p>u.histogram[_];_++)p-=u.histogram[_];var f=o+(_+(u.histogram[_]-p)/u.histogram[_])*a,g=[];return t.traverse_and_compute(h.noop,"pre-order",null,(function(n){if(!t.isLeafNode(n)){var r=h.isString(n.data.bootstrap_values)?+n.data.bootstrap_values:i;if(r>=e){for(var s=n.leaf_count*(n.leaf_count-1)*.25,l=0;l<d-1&&s>n.histogram[l];l++)s-=n.histogram[l];var c=o+(l+(n.histogram[l]-s)/n.histogram[l])*a;if(c<=f)return g.push({root:n,median:c,bootstrap:r}),!0}}return!1})),t.traverse_and_compute((function(e){t.isLeafNode(e)||"histogram"in e&&(delete e.histogram,delete e.leaf_count)})),h.each(g,(function(e){e.members=[],t.traverse_and_compute((function(n){t.isLeafNode(n)&&e.members.push(n)}),"post-order",e.root)})),g}t.centerOfTree=be,t.clusterPicker=Ae,t.computeMidpoint=ye,t.extract_dates=Le,t.fitRootToTip=ke,t.inOrder=I,t.leftChildRightSibling=U,t.loadAnnotations=S,t.pairwise_distances=me,t.parseAnnotations=M,t.phylopart=Oe,t.phylotree=ge,t.postOrder=B,t.preOrder=H,t.rootToTip=ze,t.sackin=ve,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(16614),n(64764),n(763))},1413:function(t,e,n){"use strict";n.d(e,{Z:function(){return r}});var i=n(4942);function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function r(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){(0,i.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}}}]);
//# sourceMappingURL=492.3c738e0a.chunk.js.map